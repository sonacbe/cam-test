<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Face Detection v0.7</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/face_detection.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            overflow: hidden; /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', sans-serif;
        }

        /* ë¹„ë””ì˜¤ëŠ” ë¡œì§ìš©ìœ¼ë¡œë§Œ ì“°ê³  í™”ë©´ì—” ìˆ¨ê¹ë‹ˆë‹¤ */
        #input_video {
            display: none;
        }

        /* ìº”ë²„ìŠ¤ê°€ í™”ë©´ ì „ì²´ë¥¼ ë®ìŠµë‹ˆë‹¤ */
        #output_canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* í™”ë©´ ê½‰ ì±„ìš°ê¸° */
        }

        /* ì •ë³´ í‘œì‹œìš© ì˜¤ë²„ë ˆì´ */
        .overlay-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.6); /* ë°˜íˆ¬ëª… ê²€ì • ë°°ê²½ */
            color: white;
            padding: 15px;
            border-radius: 12px;
            z-index: 10;
            pointer-events: none; /* í„°ì¹˜ ì´ë²¤íŠ¸ê°€ ìº”ë²„ìŠ¤ë¡œ í†µê³¼ë˜ë„ë¡ */
        }

        h2 {
            margin: 0 0 5px 0;
            font-size: 1.2rem;
            color: #4db8ff;
        }

        .info-text {
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre-wrap;
        }

        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2rem;
            text-align: center;
            z-index: 5;
        }
    </style>
</head>
<body>

    <div id="loading">
        ì¹´ë©”ë¼ ê¶Œí•œì„ ìš”ì²­ ì¤‘ì…ë‹ˆë‹¤...<br>
        <small>(HTTPS í™˜ê²½ í•„ìˆ˜)</small>
    </div>

    <div class="overlay-panel">
        <h2>ğŸ“· Face Detection v0.7</h2>
        <div id="statusInfo" class="info-text">ì´ˆê¸°í™” ì¤‘...</div>
    </div>

    <video id="input_video" playsinline webkit-playsinline></video>
    <canvas id="output_canvas"></canvas>

    <script>
        const videoElement = document.getElementById('input_video');
        const canvasElement = document.getElementById('output_canvas');
        const canvasCtx = canvasElement.getContext('2d');
        const statusInfo = document.getElementById('statusInfo');
        const loadingDiv = document.getElementById('loading');

        // ëª¨ë°”ì¼ ëŒ€ì‘: ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ í™”ë©´ í¬ê¸°ë¡œ ì„¤ì •
        function resizeCanvas() {
            canvasElement.width = window.innerWidth;
            canvasElement.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        function onResults(results) {
            // ë¡œë”© í…ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°
            loadingDiv.style.display = 'none';

            // 1. ìº”ë²„ìŠ¤ ì´ˆê¸°í™” ë° ì˜ìƒ ê·¸ë¦¬ê¸°
            // í™”ë©´ ê½‰ ì°¨ê²Œ ê·¸ë¦¬ê¸° ìœ„í•´ ë¹„ìœ¨ ê³„ì‚° (Object-fit: cover êµ¬í˜„)
            const imgAspect = results.image.width / results.image.height;
            const canvasAspect = canvasElement.width / canvasElement.height;
            
            let drawWidth, drawHeight, offsetX, offsetY;

            if (imgAspect < canvasAspect) {
                drawWidth = canvasElement.width;
                drawHeight = canvasElement.width / imgAspect;
                offsetX = 0;
                offsetY = (canvasElement.height - drawHeight) / 2;
            } else {
                drawHeight = canvasElement.height;
                drawWidth = canvasElement.height * imgAspect;
                offsetX = (canvasElement.width - drawWidth) / 2;
                offsetY = 0;
            }

            canvasCtx.save();
            canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
            
            // ë¹„ë””ì˜¤ í”„ë ˆì„ì„ ìº”ë²„ìŠ¤ ì „ì²´ì— ê½‰ ì°¨ê²Œ ê·¸ë¦¬ê¸°
            canvasCtx.drawImage(results.image, offsetX, offsetY, drawWidth, drawHeight);

            if (results.detections.length > 0) {
                let infoText = `ê°ì§€ëœ ì–¼êµ´: ${results.detections.length}ëª…\n`;
                
                results.detections.forEach((detection, index) => {
                    // 2. ë°”ìš´ë”© ë°•ìŠ¤ ì¢Œí‘œ ë³€í™˜ (0
